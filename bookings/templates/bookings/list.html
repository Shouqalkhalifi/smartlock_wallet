<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Ù„ÙˆØ­Ø© Ø§Ù„Ø­Ø¬Ø² Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©</title>
  <style>
    body { font-family: sans-serif; background: #f3f4f6; margin: 20px; }
    table { width: 100%; border-collapse: collapse; background: white; }
    th, td { padding: 10px; border-bottom: 1px solid #ccc; text-align: center; }
    form { margin-bottom: 30px; background: white; padding: 20px; border-radius: 10px; }
    .actions { display: flex; gap: 8px; justify-content: center; flex-wrap: wrap; }
    .btn { padding: 6px 10px; border: 1px solid #ddd; background: #111827; color: #fff; border-radius: 6px; cursor: pointer; }
    .btn.cancel { background: #9b1c1c; }
    .badge { display:inline-block; padding:2px 8px; border-radius: 9999px; font-size: 12px; }
    .badge.pending { background:#fef3c7; color:#92400e; }
    .badge.confirmed { background:#d1fae5; color:#065f46; }
    .badge.cancelled { background:#fee2e2; color:#991b1b; }
  </style>
</head>
<body>
  <h1>ğŸ“‹ Ù„ÙˆØ­Ø© Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</h1>

  <form method="post">
    {% csrf_token %}
    <label>Ø§Ø³Ù… Ø§Ù„Ù†Ø²ÙŠÙ„:</label>
    <input type="text" name="guest_name" required>
    <label>Ø±Ù‚Ù… Ø§Ù„ØºØ±ÙØ©:</label>
    <input type="text" name="room_id" required>
    <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¯Ø®ÙˆÙ„:</label>
    <input type="datetime-local" name="start_at" required>
    <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø®Ø±ÙˆØ¬:</label>
    <input type="datetime-local" name="end_at" required>
    <button type="submit">Ø¥Ø¶Ø§ÙØ©</button>
  </form>

  <table>
    <tr>
      <th>Ø§Ù„Ø§Ø³Ù…</th>
      <th>Ø§Ù„ØºØ±ÙØ©</th>
      <th>Ù…Ù†</th>
      <th>Ø¥Ù„Ù‰</th>
      <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
      <th>Ø§Ù„ÙˆØµÙˆÙ„</th>
      <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
    </tr>
    {% for b in bookings %}
    <tr>
      <td>{{ b.guest_name }}</td>
      <td>{{ b.room_id }}</td>
      <td>{{ b.start_at|date:"Y-m-d H:i" }}</td>
      <td>{{ b.end_at|date:"Y-m-d H:i" }}</td>
      <td>
        <span class="badge {{ b.status }}">{{ b.status }}</span>
      </td>
      <td>
        {% if b.accesspass %}
          {% if b.accesspass.code %}
            <div>ÙƒÙˆØ¯: <strong>{{ b.accesspass.code }}</strong></div>
          {% endif %}
          {% if b.accesspass.wallet_jwt %}
            <a href="https://pay.google.com/gp/v/save/{{ b.accesspass.wallet_jwt }}" target="_blank">Ø­ÙØ¸ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© (Google Wallet)</a>
          {% endif %}
        {% else %}
          â€”
        {% endif %}
      </td>
      <td>
        <div class="actions">
          {% if b.status == 'pending' %}
            <form method="post" action="/bookings/{{ b.id }}/confirm/">
              {% csrf_token %}
              <button class="btn" type="submit">ØªØ£ÙƒÙŠØ¯ ÙˆØ¥ØµØ¯Ø§Ø± Ø¨Ø·Ø§Ù‚Ø©</button>
            </form>
          {% endif %}
          {% if b.status != 'cancelled' %}
            <form method="post" action="/bookings/{{ b.id }}/cancel/">
              {% csrf_token %}
              <button class="btn cancel" type="submit">Ø¥Ù„ØºØ§Ø¡/Ø¥Ø¨Ø·Ø§Ù„ Ø§Ù„ÙˆØµÙˆÙ„</button>
            </form>
          {% endif %}
        </div>
      </td>
    </tr>
    {% empty %}
    <tr><td colspan="7">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø¬ÙˆØ²Ø§Øª Ø¨Ø¹Ø¯</td></tr>
    {% endfor %}
  </table>
</body>
</html>
